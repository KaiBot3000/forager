{% extends 'base.html' %}

{% block title %}Add a Plant{% endblock %}      

{% block content %}

    <div>
    <h1>Add a Plant</h1>
    <div id='addForm'>    
        <form action='/add' method='POST'>
            <label><b>Plant Name:</b>
                <input type='text' name='name' maxlength='75' required>
            </label><br><br>
            <label><b>Plant species:</b>
                <input type='text' maxlength='75' name='species'>
            </label><br><br>
            <label><b>Plant Description:</b>
                <input type='text' name='description' maxlength='250' required>
            </label><br><br>
            <label><b>Select A Category:</b><br>
                <input type='radio' name='category' value='FruitO'>Fruit bush/vine</input><br>
                <input type='radio' name='category' value='FruitT'>Fruit Tree</input><br>
                <input type='radio' name='category' value='OtherT'>Other Tree</input><br>
                <input type='radio' name='category' value='Herb'>Herb</input><br>
                <input type='radio' name='category' value='Vegetable'>Vegetable</input><br><br>
            <label><b>Select Season the Plant is Ripe:</b><br>
                <input type='checkbox' name='season' value='Spring'>Spring</input><br>
                <input type='checkbox' name='season' value='Summer'>Summer</input><br>
                <input type='checkbox' name='season' value='Fall'>Fall</input><br>
                <input type='checkbox' name='season' value='Winter'>Winter</input><br><br>
            <input type='submit' value='Add'>
        </form>
    </div>

    <div id='map'> Hay, I'm loading a map </div>




    <meta name='viewport' content='initial-scale=1,maximum-scale=1,user-scalable=no' />
    
    <script src='https://api.mapbox.com/mapbox.js/v2.2.1/mapbox.js'></script>
    
    <link href='https://api.mapbox.com/mapbox.js/v2.2.1/mapbox.css' rel='stylesheet' />

    <script src='https://api.mapbox.com/mapbox.js/plugins/leaflet-markercluster/v0.4.0/leaflet.markercluster.js'></script>

    <link href='https://api.mapbox.com/mapbox.js/plugins/leaflet-markercluster/v0.4.0/MarkerCluster.css' rel='stylesheet' />

    <link href='https://api.mapbox.com/mapbox.js/plugins/leaflet-markercluster/v0.4.0/MarkerCluster.Default.css' rel='stylesheet' />

    <script>

        var centerLat = 37.75768707689704;
        var centerLon = -122.44279861450195;
        var mapLocation = [centerLat, centerLon]; 
        var mapZoom = 12; //12 is ideal for showing SF, 15 shows markers for testing
        var plantLocation; // this becomes a position object, with lat and long keys.
        var plantDragged = false;

        // this is public on purpose
        L.mapbox.accessToken = 'pk.eyJ1IjoicmlzZWxpa2V0aGVtb29uIiwiYSI6IjI4MjczOTIwNzE5MTY1ODI4YmYxZGVlZGZmYjc4NmI0In0.fiUOgIDwB_ByzxT63VWP-g';

        var map = L.mapbox.map('map', 'riselikethemoon.4b711c00')
            .setView(mapLocation, mapZoom) 
            .addLayer(L.mapbox.tileLayer('riselikethemoon.4b711c00'));

        // code to generate marker
        var marker = L.marker(new L.LatLng(centerLat, centerLon), {
            icon: L.mapbox.marker.icon({
                'marker-color': 'ff8888'
            }),
            draggable: true
        });
        var popupContent = '<b>Hey</b>';

        marker.bindPopup(popupContent);
        marker.addTo(map);

        
        // gets location of dragged marker, allows user to submit
        marker.on('dragend', function(evt){
            plantLocation = marker.getLatLng();
            plantDragged = true;
            console.log('plant dragged to ' + plantLocation['lat'] + ', ' + plantLocation['lng']);
        });

    </script>




{% endblock %}